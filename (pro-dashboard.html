<!DOCTYPE html>
<html>
<head>
    <title>AI App Hub | Dashboard</title>
    <style>
        body { background: #020617; color: white; font-family: 'Inter', sans-serif; margin: 0; display: flex; }
        .sidebar { width: 260px; background: #0f172a; height: 100vh; padding: 25px; border-right: 1px solid #1e293b; position: fixed; }
        .main { margin-left: 310px; padding: 40px; width: 100%; }
        .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }
        .card { background: #1e293b; border-radius: 15px; padding: 20px; border: 1px solid #334155; transition: 0.3s; }
        .card:hover { transform: translateY(-5px); border-color: #3b82f6; }
        .btn-ai { background: linear-gradient(45deg, #10b981, #3b82f6); color: white; padding: 12px; border: none; border-radius: 8px; cursor: pointer; width: 100%; font-weight: bold; margin-bottom: 20px; }
        .btn-open { background: #334155; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-top: 10px; }
    </style>
</head>
<body>
    <div class="sidebar">
        <h2>ðŸš€ AI Studio</h2>
        <button class="btn-ai" onclick="location.href='ai-magic-page.html'">+ Build with AI</button>
        <hr style="border: 0.5px solid #1e293b;">
        <p style="color: #64748b;">My AI Projects</p>
    </div>

    <div class="main">
        <h1>Your Generated Apps</h1>
        <div id="project-list" class="grid">
            <p id="loading">Loading your apps... ðŸ“¡</p>
        </div>
    </div>

    <script type="module">
        import { supabase } from './engine-base.js';

        async function loadApps() {
            const { data, error } = await supabase.from('projects').select('*').order('created_at', { ascending: false });
            
            const list = document.getElementById('project-list');
            list.innerHTML = ''; // Loading text hatao

            if (data) {
                data.forEach(proj => {
                    const card = document.createElement('div');
                    card.className = 'card';
                    card.innerHTML = `
                        <h3>${proj.name || 'Untitled App'}</h3>
                        <p style="font-size:12px; color:#94a3b8;">Created: ${new Date(proj.created_at).toLocaleDateString()}</p>
                        <button class="btn-open" onclick="viewCode('${proj.id}')">Open Preview</button>
                    `;
                    list.appendChild(card);
                });
            }
        }
        window.viewCode = (id) => { location.href = `app-core.html?id=${id}`; };
        loadApps();
    </script>
</body>
</html>
